@page "{id:Guid}"
@using Lucent.Common.Entities
@model Lucent.Portal.Models.EditCampaignModel
@{
    Layout = "~/Pages/Shared/_Layout.cshtml";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Edit " + Model.Campaign.Name;
}

<h1>Edit Campaign - @Model.Campaign.Name</h1>
<form method="POST">
    <div asp-validation-summary="All"></div>
    <input asp-for="Campaign.Id" type="hidden" />
    <partial name="CampaignMetadata" for="Campaign" />
    <partial name="CampaignSchedule" for="Campaign.Schedule" />
    <h2>Creatives</h2>
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var creative in Model.Campaign.Creatives)
            {
                <tr>
                    <td>@creative.Id</td>
                    <td>@creative.Name</td>
                    <td>
                        <input type="submit" class="btn btn-link" asp-page-handler="RemoveCreative" 
                                asp-route-id="@creative.Id" value="remove" />
                    </td>
                </tr>
            }
            @foreach (var creative in Model.CreativeCatalog)
            {
                @if(!Model.Campaign.Creatives.Any(c=>c.Id == @creative.Id))
                {
                <tr>
                    <td>@creative.Id</td>
                    <td>@creative.Name</td>
                    <td>
                        <input type="submit" asp-page="./Edit" class="btn btn-link" asp-page-handler="AddCreative" 
                                asp-route-id="@creative.Id" value="add"/>
                    </td>
                </tr>
                }
            }
        </tbody>
    </table>
    <input class="btn btn-secondary" type="submit"/>
</form>